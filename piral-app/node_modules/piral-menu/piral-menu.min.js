var piralMenu=(()=>{var _=Object.create;var g=Object.defineProperty,$=Object.defineProperties,j=Object.getOwnPropertyDescriptor,O=Object.getOwnPropertyDescriptors,q=Object.getOwnPropertyNames,R=Object.getOwnPropertySymbols,v=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var A=(e,t,n)=>t in e?g(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,o=(e,t)=>{for(var n in t||(t={}))b.call(t,n)&&A(e,n,t[n]);if(R)for(var n of R(t))z.call(t,n)&&A(e,n,t[n]);return e},u=(e,t)=>$(e,O(t)),D=e=>g(e,"__esModule",{value:!0});var a=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(t,n)=>(typeof require!="undefined"?require:t)[n]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var G=(e,t)=>{D(e);for(var n in t)g(e,n,{get:t[n],enumerable:!0})},B=(e,t,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of q(t))!b.call(e,r)&&r!=="default"&&g(e,r,{get:()=>t[r],enumerable:!(n=j(t,r))||n.enumerable});return e},p=e=>B(D(g(e!=null?_(v(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var V={};G(V,{Menu:()=>d,PiralMenuContainer:()=>S,PiralMenuItem:()=>x,createMenuApi:()=>U});var C={};G(C,{registerMenuItem:()=>H,unregisterMenuItem:()=>J});var I=p(a("piral-core"));function H(e,t,n){e.dispatch(r=>u(o({},r),{registry:u(o({},r.registry),{menuItems:(0,I.withKey)(r.registry.menuItems,t,n)})}))}function J(e,t){e.dispatch(n=>u(o({},n),{registry:u(o({},n.registry),{menuItems:(0,I.withoutKey)(n.registry.menuItems,t)})}))}var m=p(a("piral-core"));var w=p(a("react")),f=p(a("piral-core")),F=e=>w.createElement(f.ExtensionSlot,{name:`menu_${e.type}`,params:e,empty:()=>(0,f.defaultRender)(e.children,"default_menu")}),k=e=>(0,f.defaultRender)(e.children);var y=p(a("react")),E=p(a("piral-core"));var P=p(a("piral-core")),S=(0,P.getPiralComponent)("MenuContainer"),x=(0,P.getPiralComponent)("MenuItem");var d=({type:e="general"})=>{let t=(0,E.useGlobalState)(i=>i.registry.menuItems),r=Object.keys(t).filter(i=>t[i].settings.type===e).map(i=>({name:i,Component:t[i].component,meta:t[i].settings})).map(({name:i,Component:l,meta:c})=>y.createElement(x,{key:i,type:e,meta:c},y.createElement(l,null)));return y.createElement(S,{type:e},r)};d.displayName="Menu";function K(e,t={}){return o(o({type:"general"},e),t)}function L(e,t){let n={},r=0;for(let{component:i,settings:l}of e)n[`global-${r++}`]={pilet:void 0,component:i,settings:K(t,l)};return n}function Q(e){return t=>u(o({},t),{components:o({MenuContainer:F,MenuItem:k},t.components),registry:u(o({},t.registry),{menuItems:e})})}function U(e={}){let{items:t=[],defaultSettings:n={}}=e;return r=>(r.defineActions(C),r.dispatch((0,m.withAll)(Q(L(t,n)),(0,m.withRootExtension)("piral-menu",d))),(i,l)=>{let c=l.name,N=0;return{registerMenu(s,M,h){typeof s!="string"&&(h=M,M=s,s=N++);let T=(0,m.buildName)(c,s);return r.registerMenuItem(T,{pilet:c,component:(0,m.withApi)(r,M,i,"menu"),settings:K(n,h)}),()=>i.unregisterMenu(s)},unregisterMenu(s){let M=(0,m.buildName)(c,s);r.unregisterMenuItem(M)}}})}return V;})();
