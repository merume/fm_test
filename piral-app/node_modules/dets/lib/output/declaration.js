"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.stringifyDeclaration = void 0;
const module_1 = require("./module");
const exports_1 = require("./exports");
const helpers_1 = require("../helpers");
function stringifyDeclaration(context) {
    const { noModuleDeclaration } = context.flags;
    const modules = Object.keys(context.modules)
        .filter(moduleName => Object.keys(context.modules[moduleName]).length > 0)
        .map(moduleName => {
        const refs = context.modules[moduleName];
        if (noModuleDeclaration && moduleName === context.name) {
            return (0, exports_1.stringifyExports)(refs);
        }
        return (0, module_1.stringifyModule)(moduleName, refs);
    })
        .join('\n\n');
    const preamble = context.usedImports.map(lib => `import * as ${(0, helpers_1.getLibRefName)(lib)} from '${lib}';`).join('\n');
    if (preamble) {
        return `${preamble}\n\n${modules}`;
    }
    return modules;
}
exports.stringifyDeclaration = stringifyDeclaration;
